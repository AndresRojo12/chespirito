import{L as oe}from"./CIAY-Gyt.js";import{_ as le,A as ne,r,s as se,v as re,g as k,m as n,o as _,c as p,a as i,b as t,w as o,d,C as ce,F as B,y as ie,t as w,G as R,n as A,D as ue,z as de}from"./PexJTClo.js";import{d as _e}from"./DORaxXDF.js";import{_ as ve}from"./CG9etBrp.js";import{_ as me}from"./D7OX7uWg.js";import{u as pe}from"./Djd6y8D_.js";import"./C4iS2aBk.js";import"./DOYwHpwi.js";const fe={class:"header-container"},ge={key:0,style:{"text-align":"center"}},ye={key:1,class:"product-container"},xe=["src"],we={class:"product-info"},Pe={class:"info"},Ve={class:"info"},be={class:"info"},Ce={class:"info"},ke={class:"text-center"},he={__name:"ProductList",setup(M){const P=de(),h=ne(),f=r(!1),g=r(1),y=r(10),v=r(!1),$=r(null),m=r(!1),E=r(null),D=r([]),s=r({data:[],totalPages:1}),V=r(""),x=r(!1),u=async()=>{f.value=!0;try{const{data:a}=await pe(`${P.public.API_BASE_URL}products?page=${g.value}&pageSize=${y.value}`,{method:"GET"},"$7nKpWV8wlZ");D.value=a.value.data,s.value={data:a.value.data,totalPages:a.value.totalPages}}catch{s.value={data:[],totalPages:1}}finally{f.value=!1}};se(async()=>{await re(),await u()});const T=a=>a,j=_e(async a=>{if(await u(),!a.trim()){s.value={data:D.value,totalPages:s.value.totalPages},x.value=categories.value.length===0;return}try{const c=await(await fetch(`${P.public.API_BASE_URL}products/search?query=${encodeURIComponent(a.trim())}`)).json();s.value={data:c,totalPages:1},x.value=c.length===0}catch(e){console.error("Error fetching filtered products:",e),s.value={data:[],totalPages:1},x.value=!0}},500);k(V,a=>{j(a)}),k(g,async()=>{await u()}),k(y,async()=>{await u()});const z=a=>{a&&a.id?($.value={...a},v.value=!0):console.error("El objeto product no tiene una propiedad id válida.")},G=async a=>{if(a){const e=s.value.data.findIndex(c=>c.id===a.id);e!==-1&&(s.value.data[e]=a)}await u(),v.value=!1},X=async a=>{const e=s.value.data.findIndex(c=>c.id===a);e!==-1&&s.value.data.splice(e,1),await u(),m.value=!1},q=a=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0}).format(a),K=a=>{m.value=!0,E.value=a},O=()=>{h.push("/product/register")};return(a,e)=>{const c=n("v-btn"),W=n("v-text-field"),Z=n("v-select"),H=n("v-alert"),I=n("v-icon"),L=n("v-tooltip"),J=n("v-pagination"),b=n("v-container"),Q=n("v-col"),Y=n("v-row"),ee=n("v-card-title"),S=n("v-card-text"),U=n("v-card-actions"),F=n("v-card"),N=n("v-dialog"),te=oe;return _(),p(B,null,[i("div",fe,[t(c,{class:"register-button",onClick:ce(O,["prevent"])},{default:o(()=>e[7]||(e[7]=[d(" Registrar producto ")])),_:1}),t(W,{class:"search-field",modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=l=>V.value=l),density:"comfortable",placeholder:"Buscar Productos","prepend-inner-icon":"mdi-magnify",variant:"solo",clearable:"","hide-details":""},null,8,["modelValue"])]),t(Z,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=l=>y.value=l),class:"page-select",items:[10,20,30,40,50],label:"Seleccionar productos por página",onChange:u},null,8,["modelValue"]),!f.value&&x.value?(_(),p("div",ge,[t(H,{color:"#009c8c",type:"warning"},{default:o(()=>e[8]||(e[8]=[d(" No se encontraron registros. ")])),_:1})])):(_(),p("div",ye,[(_(!0),p(B,null,ie(s.value.data||[],l=>(_(),p("div",{class:"product-item",key:l.id},[i("div",null,[i("img",{class:"product-image",src:T(l.imagePath1)},null,8,xe)]),i("div",we,[i("h1",Pe,w(l.name),1),i("p",Ve,"Estado "+w(l.status),1),i("p",be,w(l.description),1),i("p",Ce,w(q(l.price)),1)]),t(L,{text:"Editar"},{activator:o(({props:C})=>[t(I,R({style:{color:"rgba(228, 192, 11, 0.663)"},ref_for:!0},C,{onClick:ae=>z(l)}),{default:o(()=>e[9]||(e[9]=[d(" mdi-pencil ")])),_:2},1040,["onClick"])]),_:2},1024),t(L,{text:"Eliminar"},{activator:o(({props:C})=>[t(I,R({style:{color:"darkslategrey"},ref_for:!0},C,{onClick:ae=>K(l)}),{default:o(()=>e[10]||(e[10]=[d(" mdi-delete ")])),_:2},1040,["onClick"])]),_:2},1024)]))),128))])),i("div",ke,[t(b,null,{default:o(()=>[t(Y,{justify:"center"},{default:o(()=>[t(Q,{cols:"8"},{default:o(()=>[t(b,{class:"max-width"},{default:o(()=>[t(J,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),length:s.value.totalPages||1,class:"my-4",onInput:u},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),t(N,{class:"dialog",modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=l=>v.value=l)},{default:o(()=>[t(F,null,{default:o(()=>[t(ee,{class:"dialog-title"},{default:o(()=>e[11]||(e[11]=[d("Editar Producto")])),_:1}),t(S,null,{default:o(()=>[t(ve,{product:$.value,onSave:G},null,8,["product"])]),_:1}),t(U,null,{default:o(()=>[t(c,{class:"cancel-button",onClick:e[3]||(e[3]=l=>v.value=!1)},{default:o(()=>e[12]||(e[12]=[d(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(N,{class:"dialog",modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value=l)},{default:o(()=>[t(F,null,{default:o(()=>[t(S,null,{default:o(()=>[t(me,{product:E.value,onDeleted:X},null,8,["product"])]),_:1}),t(U,null,{default:o(()=>[t(c,{class:"cancel-button",text:"",onClick:e[5]||(e[5]=l=>m.value=!1)},{default:o(()=>e[13]||(e[13]=[d(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),f.value?(_(),A(b,{key:2},{default:o(()=>[t(te)]),_:1})):ue("",!0)],64)}}},$e=le(he,[["__scopeId","data-v-771db926"]]),Be={__name:"list",setup(M){return(P,h)=>(_(),A($e))}};export{Be as default};
