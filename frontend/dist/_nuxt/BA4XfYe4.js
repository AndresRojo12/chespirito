import{_ as ae}from"./A_DV3Xvy.js";import{r,m as l,o as y,c as V,b as t,w as a,d as v,F as I,z as F,_ as oe,A as ne,s as le,v as R,g as U,a as i,C as se,y as re,n as j,D as ie,t as h,G as T,x as ce}from"./Bi-YAAcS.js";import{C as ue}from"./CCXqvrfn.js";import{S as z}from"./DOYwHpwi.js";import{u as q}from"./G8Xyjgfx.js";import{L as de}from"./DKrGet5X.js";const _e={__name:"CategoryDelete",props:{category:Object},emits:["deleted"],setup(k,{emit:x}){const w=F(),p=k,m=x,f=r({...p.category}),g=async()=>{try{await q(`${w.public.API_BASE_URL}categories/${p.category.id}`,{method:"DELETE"},"$o02dgv0U7J")!=null?(z.fire({title:"Eliminado",text:"Categoría eliminada correctamente",icon:"success",confirmButtonText:"Aceptar"}),m("deleted",f.value.id)):(z.fire({title:"Error",text:"No se pudo eliminar la categoría",icon:"error",confirmButtonText:"Aceptar"}),m("deleted",!1,null))}catch(c){console.log("Error",c)}};return(c,u)=>{const b=l("v-card-title"),E=l("v-card-text"),s=l("v-btn"),C=l("v-card-actions");return y(),V(I,null,[t(b,{class:"headline"},{default:a(()=>u[0]||(u[0]=[v("Eliminar categoría")])),_:1}),t(E,null,{default:a(()=>u[1]||(u[1]=[v("¿Estás seguro que quieres eliminar esta categoría?")])),_:1}),t(C,null,{default:a(()=>[t(s,{color:"green darken-1",text:"",onClick:g},{default:a(()=>u[2]||(u[2]=[v("Si, eliminar")])),_:1})]),_:1})],64)}}},ve={class:"header-container"},me={class:"category-container"},ge=["src"],pe={class:"category-info"},fe={class:"text-center"},ye={__name:"InterfazUser",setup(k){const x=F(),w=ne(),p=r(!1),m=r(1),f=r(10),g=r(!1),c=r(!1),u=r(null),b=r(null),E=r([]),s=r({data:[],totalPages:1}),C=r(""),_=async()=>{p.value=!0;try{const{data:o}=await q(`${x.public.API_BASE_URL}categories?page=${m.value}&pageSize=${f.value}`,"$CbwfwtgAsP");if(o.value)E.value=o.value.data,s.value=o.value;else throw new Error("No se recibieron datos válidos");p.value=!1}catch(o){console.error("Error fetching categories:",o),s.value={data:[],totalPages:1}}},G=o=>o;le(async()=>{await R(),await _()}),U(C,async o=>{if(await _(),!o.trim()){s.value={data:E.value,totalPages:s.value.totalPages};return}try{const d=await(await fetch(`${x.public.API_BASE_URL}categories/search?query=${encodeURIComponent(o.trim())}`)).json();s.value={data:d,totalPages:1}}catch(e){console.error("Error fetching filtered categories:",e),s.value={data:[],totalPages:1}}}),U(m,async()=>{await _()}),U(f,async()=>{await _()});const O=o=>{o&&o.id?(u.value={...o},g.value=!0):console.error("La categoría no tiene una propiedad id válida.")},M=async o=>{if(o){const e=s.value.data.findIndex(d=>d.id===o.id);e!==-1&&(s.value.data[e]=o)}await _(),g.value=!1},J=async o=>{const e=s.value.data.findIndex(d=>d.id===o);e!==-1&&s.value.data.splice(e,1),await _(),c.value=!1},H=async()=>{await R(),await w.push("/categories/register")},K=async o=>{b.value=o,c.value=!0};return(o,e)=>{const d=l("v-btn"),Q=l("v-text-field"),W=l("v-select"),X=ae,S=l("v-icon"),D=l("v-tooltip"),Y=l("v-pagination"),$=l("v-container"),Z=l("v-col"),ee=l("v-row"),A=l("v-card-text"),B=l("v-card-actions"),L=l("v-card"),N=l("v-dialog");return y(),V(I,null,[i("div",null,[i("div",ve,[t(d,{onClick:se(H,["prevent"]),class:"register-button"},{default:a(()=>e[7]||(e[7]=[v("Registrar categoría")])),_:1}),t(Q,{class:"search-field",modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=n=>C.value=n),density:"comfortable",placeholder:"Buscar categorías","prepend-inner-icon":"mdi-magnify",variant:"solo",clearable:"","hide-details":""},null,8,["modelValue"])]),t(W,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=n=>f.value=n),class:"page-select",items:[10,20,30,40,50],label:"Seleccionar categorías por página",onChange:_},null,8,["modelValue"]),i("div",me,[(y(!0),V(I,null,re(s.value.data||[],n=>(y(),V("div",{class:"category-item",key:n.id},[i("div",null,[i("img",{class:"category-image",src:G(n.imagePath)},null,8,ge)]),t(X,{to:`/categories/${n.id}`},{default:a(()=>[i("button",pe,[i("h3",null,h(n.name),1),i("p",null,h(n.description),1)])]),_:2},1032,["to"]),t(D,{text:"Editar"},{activator:a(({props:P})=>[t(S,T({ref_for:!0},P,{onClick:te=>O(n),style:{color:"rgba(228, 192, 11, 0.663)"}}),{default:a(()=>e[8]||(e[8]=[v(" mdi-pencil ")])),_:2},1040,["onClick"])]),_:2},1024),t(D,{text:"Eliminar"},{activator:a(({props:P})=>[t(S,T({ref_for:!0},P,{onClick:te=>K(n),style:{color:"darkslategrey"}}),{default:a(()=>e[9]||(e[9]=[v(" mdi-delete ")])),_:2},1040,["onClick"])]),_:2},1024)]))),128))]),i("div",fe,[t($,null,{default:a(()=>[t(ee,{justify:"center"},{default:a(()=>[t(Z,{cols:"8"},{default:a(()=>[t($,{class:"max-width"},{default:a(()=>[t(Y,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=n=>m.value=n),length:s.value.totalPages||1,class:"my-4",onInput:_},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),t(N,{class:"dialog",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=n=>g.value=n)},{default:a(()=>[t(L,null,{default:a(()=>[e[11]||(e[11]=i("h1",{class:"dialog-title"},"Editar Categoría",-1)),t(A,null,{default:a(()=>[t(ue,{category:u.value,onSave:M},null,8,["category"])]),_:1}),t(B,null,{default:a(()=>[t(d,{class:"cancel-button",text:"",onClick:e[3]||(e[3]=n=>g.value=!1)},{default:a(()=>e[10]||(e[10]=[v("Cancelar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(N,{class:"dialog",modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=n=>c.value=n)},{default:a(()=>[t(L,null,{default:a(()=>[t(A,null,{default:a(()=>[t(_e,{category:b.value,onDeleted:J},null,8,["category"])]),_:1}),t(B,null,{default:a(()=>[t(d,{color:"blue darken-1",text:"",onClick:e[5]||(e[5]=n=>c.value=!1)},{default:a(()=>e[12]||(e[12]=[v(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),p.value?(y(),j($,{key:0},{default:a(()=>[t(de)]),_:1})):ie("",!0)],64)}}},xe=oe(ye,[["__scopeId","data-v-a2927186"]]),$e={__name:"gestion",setup(k){return(x,w)=>(y(),j(ce(xe)))}};export{$e as default};
