import{_ as U,A as z,r as i,B as F,s as L,v as O,m as u,o as y,c as q,b as r,w as m,d as v,x as f,a as _,C as $,F as M,z as G,n as Q}from"./DU8ZY_np.js";import{S as k}from"./DOYwHpwi.js";import{u as g}from"./nGlY6G32.js";const j={class:"submit-buttons"},D={__name:"InventariesRegister",setup(B){const c=G(),I=z(),n=i(""),l=i(""),b=i([]),A=i(1),x=i(10),s=F({sales:[],status:[]}),C=()=>{const t=parseInt(n.value);return isNaN(t)||t<1?(s.sales=["El producto es requerido, selecciona el correspondiente"],!1):!0},R=()=>{const t=l.value.trim();return t?t.length<8?(s.status=["El estado debe tener por lo menos 8 caracteres"],!1):t.length>50?(s.status=["El estado no puede exceder los 50 caracteres"],!1):!0:(s.status=["El estado es requerido, por favor indique estado de inventario"],!1)},N=()=>{for(const a in s)s.hasOwnProperty(a)&&(s[a]=[]);const t=C(),e=R();return t&&e},P=async()=>{const{data:t}=await g(`${c.public.API_BASE_URL}sales?page=1&pageSize=1`,"$VtM1bXtg3I"),e=t.value.totalItems;x.value=e;const{data:a,error:p}=await g(`${c.public.API_BASE_URL}sales?page=${A.value}&pageSize=${x.value}`,"$cfppCCT9QU");if(a.value!=null)b.value=a.value.data.map(d=>({id:d.id,products:d.products}));else throw new Error(p.value.message)};L(async()=>{await O(),await P()});const S=async()=>{if(!N())return;const{data:t,error:e}=await g(`${c.public.API_BASE_URL}inventories`,{method:"POST",body:{status:l.value,salesId:n.value},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}},"$GKxQSNLfgc");t.value!=null?(k.fire({title:"Inventario registrado con Ã©xito!",icon:"success",confirmButtonText:"Aceptar"}),w()):k.fire({title:"No se pudo registrar inventario",text:"Este producto ya ha sido registrado pon un producto y un estado diferentes",icon:"error",confirmButtonText:"Aceptar"})},w=()=>{for(const t of Object.keys(s))t==="sales"&&(n.value=""),t==="status"&&(l.value=""),s[t]=[]},E=t=>{s[t]=[]};return(t,e)=>{const a=u("v-icon"),p=u("v-autocomplete"),d=u("v-text-field"),V=u("v-btn"),T=u("v-container");return y(),q(M,null,[r(a,{class:"exit-icon",onClick:e[0]||(e[0]=o=>f(I).back())},{default:m(()=>e[5]||(e[5]=[v("mdi-arrow-left")])),_:1}),r(T,{class:"form-container"},{default:m(()=>[e[8]||(e[8]=_("h1",{class:"form-title"},"Registro de inventario",-1)),_("form",{onSubmit:$(S,["prevent"])},[r(p,{class:"select",modelValue:n.value,"onUpdate:modelValue":[e[1]||(e[1]=o=>n.value=o),e[2]||(e[2]=o=>E("sales"))],items:b.value,"item-title":"products.name","item-value":"id",label:"Seleccionar producto vendido","error-messages":f(s).sales},null,8,["modelValue","items","error-messages"]),r(d,{class:"input",modelValue:l.value,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value=o),label:"Estado","error-messages":f(s).status,onInput:e[4]||(e[4]=o=>E("status"))},null,8,["modelValue","error-messages"]),_("div",j,[r(V,{onClick:$(S,["prevent"]),class:"submit"},{default:m(()=>e[6]||(e[6]=[v("Enviar")])),_:1}),r(V,{class:"clean",onClick:w},{default:m(()=>e[7]||(e[7]=[v("Limpiar")])),_:1})])],32)]),_:1})],64)}}},K=U(D,[["__scopeId","data-v-9152eafe"]]),W={__name:"register",setup(B){return(c,I)=>(y(),Q(K))}};export{W as default};
