import{L as ee}from"./DKrGet5X.js";import{_ as te,A as ae,r as c,s as oe,v as le,g as C,m as n,o as m,c as b,a as r,b as t,w as o,d as u,C as ne,F as N,y as se,t as g,G as F,n as R,D as ce,z as re}from"./Bi-YAAcS.js";import{_ as ie}from"./9lU8M3Ga.js";import{_ as de}from"./DeuZzX_M.js";import{u as ue}from"./G8Xyjgfx.js";import"./DOYwHpwi.js";const _e={class:"header-container"},ve={class:"product-container"},me=["src"],pe={class:"product-info"},fe={class:"info"},ge={class:"info"},ye={class:"info"},xe={class:"info"},Pe={class:"text-center"},Ve={__name:"ProductList",setup(A){const y=re(),k=ae(),x=c(!1),p=c(1),f=c(10),_=c(!1),$=c(null),v=c(!1),E=c(null),h=c([]),s=c({data:[],totalPages:1}),P=c(""),d=async()=>{x.value=!0;try{const{data:a}=await ue(`${y.public.API_BASE_URL}products?page=${p.value}&pageSize=${f.value}`,{method:"GET"},"$7nKpWV8wlZ");h.value=a.value.data,s.value={data:a.value.data,totalPages:a.value.totalPages},x.value=!1}catch{s.value={data:[],totalPages:1}}};oe(async()=>{await le(),await d()});const M=a=>a;C(P,async a=>{if(!a.trim()){s.value={data:h.value,totalPages:s.value.totalPages};return}try{const i=await(await fetch(`${y.public.API_BASE_URL}products/search?query=${encodeURIComponent(a.trim())}`)).json();s.value={data:i,totalPages:1}}catch(e){console.error("Error fetching filtered products:",e),s.value={data:[],totalPages:1}}}),C(p,async()=>{await d()}),C(f,async()=>{await d()});const T=a=>{a&&a.id?($.value={...a},_.value=!0):console.error("El objeto product no tiene una propiedad id válida.")},j=async a=>{if(a){const e=s.value.data.findIndex(i=>i.id===a.id);e!==-1&&(s.value.data[e]=a)}await d(),_.value=!1},z=async a=>{const e=s.value.data.findIndex(i=>i.id===a);e!==-1&&s.value.data.splice(e,1),await d(),v.value=!1},G=a=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0}).format(a),X=a=>{v.value=!0,E.value=a},q=()=>{k.push("/product/register")};return(a,e)=>{const i=n("v-btn"),K=n("v-text-field"),O=n("v-select"),D=n("v-icon"),I=n("v-tooltip"),W=n("v-pagination"),V=n("v-container"),Z=n("v-col"),H=n("v-row"),J=n("v-card-title"),L=n("v-card-text"),S=n("v-card-actions"),U=n("v-card"),B=n("v-dialog"),Q=ee;return m(),b(N,null,[r("div",_e,[t(i,{class:"register-button",onClick:ne(q,["prevent"])},{default:o(()=>e[7]||(e[7]=[u(" Registrar producto ")])),_:1}),t(K,{class:"search-field",modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=l=>P.value=l),density:"comfortable",placeholder:"Buscar Productos","prepend-inner-icon":"mdi-magnify",variant:"solo",clearable:"","hide-details":""},null,8,["modelValue"])]),t(O,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=l=>f.value=l),class:"page-select",items:[10,20,30,40,50],label:"Seleccionar productos por página",onChange:d},null,8,["modelValue"]),r("div",ve,[(m(!0),b(N,null,se(s.value.data||[],l=>(m(),b("div",{class:"product-item",key:l.id},[r("div",null,[r("img",{class:"product-image",src:M(l.imagePath1)},null,8,me)]),r("div",pe,[r("h1",fe,g(l.name),1),r("p",ge,"Estado "+g(l.status),1),r("p",ye,g(l.description),1),r("p",xe,g(G(l.price)),1)]),t(I,{text:"Editar"},{activator:o(({props:w})=>[t(D,F({style:{color:"rgba(228, 192, 11, 0.663)"},ref_for:!0},w,{onClick:Y=>T(l)}),{default:o(()=>e[8]||(e[8]=[u(" mdi-pencil ")])),_:2},1040,["onClick"])]),_:2},1024),t(I,{text:"Eliminar"},{activator:o(({props:w})=>[t(D,F({style:{color:"darkslategrey"},ref_for:!0},w,{onClick:Y=>X(l)}),{default:o(()=>e[9]||(e[9]=[u(" mdi-delete ")])),_:2},1040,["onClick"])]),_:2},1024)]))),128))]),r("div",Pe,[t(V,null,{default:o(()=>[t(H,{justify:"center"},{default:o(()=>[t(Z,{cols:"8"},{default:o(()=>[t(V,{class:"max-width"},{default:o(()=>[t(W,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),length:s.value.totalPages||1,class:"my-4",onInput:d},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{class:"dialog",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=l=>_.value=l)},{default:o(()=>[t(U,null,{default:o(()=>[t(J,{class:"dialog-title"},{default:o(()=>e[10]||(e[10]=[u("Editar Producto")])),_:1}),t(L,null,{default:o(()=>[t(ie,{product:$.value,onSave:j},null,8,["product"])]),_:1}),t(S,null,{default:o(()=>[t(i,{class:"cancel-button",onClick:e[3]||(e[3]=l=>_.value=!1)},{default:o(()=>e[11]||(e[11]=[u(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(B,{class:"dialog",modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=l=>v.value=l)},{default:o(()=>[t(U,null,{default:o(()=>[t(L,null,{default:o(()=>[t(de,{product:E.value,onDeleted:z},null,8,["product"])]),_:1}),t(S,null,{default:o(()=>[t(i,{class:"cancel-button",text:"",onClick:e[5]||(e[5]=l=>v.value=!1)},{default:o(()=>e[12]||(e[12]=[u(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),x.value?(m(),R(V,{key:0},{default:o(()=>[t(Q)]),_:1})):ce("",!0)],64)}}},we=te(Ve,[["__scopeId","data-v-4aadc341"]]),De={__name:"list",setup(A){return(y,k)=>(m(),R(we))}};export{De as default};
