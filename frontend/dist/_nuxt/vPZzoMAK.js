import{_ as J,A as Q,r as i,s as Y,v as tt,g as w,m as n,o as g,c as V,a as c,b as e,w as l,d as u,C as et,F,y as at,t as f,E as N,z as ot,n as lt}from"./DmKkRkWq.js";import{_ as nt}from"./DFI1NIeQ.js";import{_ as st}from"./ETw6oKOk.js";import{u as ct}from"./Cjgx8Lvs.js";import"./DOYwHpwi.js";const rt={class:"header-container"},it={class:"product-container"},dt=["src"],ut={class:"product-info"},_t={class:"info"},vt={class:"info"},mt={class:"info"},pt={class:"info"},ft={class:"text-center"},gt={__name:"ProductList",setup(R){const y=ot(),C=Q(),m=i(1),p=i(10),_=i(!1),b=i(null),v=i(!1),k=i(null),E=i([]),s=i({data:[],totalPages:1}),x=i(""),d=async()=>{try{const{data:a}=await ct(`${y.public.API_BASE_URL}products?page=${m.value}&pageSize=${p.value}`,{method:"GET"},"$7nKpWV8wlZ");E.value=a.value.data,s.value={data:a.value.data,totalPages:a.value.totalPages}}catch{s.value={data:[],totalPages:1}}};Y(async()=>{await tt(),await d()});const A=a=>a;w(x,async a=>{if(!a.trim()){s.value={data:E.value,totalPages:s.value.totalPages};return}try{const r=await(await fetch(`${y.public.API_BASE_URL}products/search?query=${encodeURIComponent(a.trim())}`)).json();s.value={data:r,totalPages:1}}catch(t){console.error("Error fetching filtered products:",t),s.value={data:[],totalPages:1}}}),w(m,async()=>{await d()}),w(p,async()=>{await d()});const L=a=>{a&&a.id?(b.value={...a},_.value=!0):console.error("El objeto product no tiene una propiedad id válida.")},M=async a=>{if(a){const t=s.value.data.findIndex(r=>r.id===a.id);t!==-1&&(s.value.data[t]=a)}await d(),_.value=!1},T=async a=>{const t=s.value.data.findIndex(r=>r.id===a);t!==-1&&s.value.data.splice(t,1),await d(),v.value=!1},j=a=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0}).format(a),z=a=>{v.value=!0,k.value=a},G=()=>{C.push("/product/register")};return(a,t)=>{const r=n("v-btn"),X=n("v-text-field"),q=n("v-select"),$=n("v-icon"),h=n("v-tooltip"),K=n("v-pagination"),I=n("v-container"),O=n("v-col"),W=n("v-row"),Z=n("v-card-title"),D=n("v-card-text"),U=n("v-card-actions"),B=n("v-card"),S=n("v-dialog");return g(),V(F,null,[c("div",rt,[e(r,{class:"register-button",onClick:et(G,["prevent"])},{default:l(()=>t[7]||(t[7]=[u(" Registrar producto ")])),_:1}),e(X,{class:"search-field",modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=o=>x.value=o),density:"comfortable",placeholder:"Buscar Productos","prepend-inner-icon":"mdi-magnify",variant:"solo",clearable:"","hide-details":""},null,8,["modelValue"])]),e(q,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=o=>p.value=o),class:"page-select",items:[10,20,30,40,50],label:"Seleccionar productos por página",onChange:d},null,8,["modelValue"]),c("div",it,[(g(!0),V(F,null,at(s.value.data||[],o=>(g(),V("div",{class:"product-item",key:o.id},[c("div",null,[c("img",{class:"product-image",src:A(o.imagePath1)},null,8,dt)]),c("div",ut,[c("h1",_t,f(o.name),1),c("p",vt,"Estado "+f(o.status),1),c("p",mt,f(o.description),1),c("p",pt,f(j(o.price)),1)]),e(h,{text:"Editar"},{activator:l(({props:P})=>[e($,N({style:{color:"rgba(228, 192, 11, 0.663)"},ref_for:!0},P,{onClick:H=>L(o)}),{default:l(()=>t[8]||(t[8]=[u(" mdi-pencil ")])),_:2},1040,["onClick"])]),_:2},1024),e(h,{text:"Eliminar"},{activator:l(({props:P})=>[e($,N({style:{color:"darkslategrey"},ref_for:!0},P,{onClick:H=>z(o)}),{default:l(()=>t[9]||(t[9]=[u(" mdi-delete ")])),_:2},1040,["onClick"])]),_:2},1024)]))),128))]),c("div",ft,[e(I,null,{default:l(()=>[e(W,{justify:"center"},{default:l(()=>[e(O,{cols:"8"},{default:l(()=>[e(I,{class:"max-width"},{default:l(()=>[e(K,{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=o=>m.value=o),length:s.value.totalPages||1,class:"my-4",onInput:d},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(S,{class:"dialog",modelValue:_.value,"onUpdate:modelValue":t[4]||(t[4]=o=>_.value=o)},{default:l(()=>[e(B,null,{default:l(()=>[e(Z,{class:"dialog-title"},{default:l(()=>t[10]||(t[10]=[u("Editar Producto")])),_:1}),e(D,null,{default:l(()=>[e(nt,{product:b.value,onSave:M},null,8,["product"])]),_:1}),e(U,null,{default:l(()=>[e(r,{class:"cancel-button",onClick:t[3]||(t[3]=o=>_.value=!1)},{default:l(()=>t[11]||(t[11]=[u(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(S,{class:"dialog",modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=o=>v.value=o)},{default:l(()=>[e(B,null,{default:l(()=>[e(D,null,{default:l(()=>[e(st,{product:k.value,onDeleted:T},null,8,["product"])]),_:1}),e(U,null,{default:l(()=>[e(r,{class:"cancel-button",text:"",onClick:t[5]||(t[5]=o=>v.value=!1)},{default:l(()=>t[12]||(t[12]=[u(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])],64)}}},yt=J(gt,[["__scopeId","data-v-c1b7fc35"]]),bt={__name:"list",setup(R){return(y,C)=>(g(),lt(yt))}};export{bt as default};
