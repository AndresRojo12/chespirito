import{_ as K,A as Q,r as o,B as W,s as X,v as Y,m as c,o as q,c as Z,b as s,w as y,d as $,x as l,a as I,C as h,z as ee,n as re}from"./DkewYONJ.js";import{S as N}from"./DOYwHpwi.js";import{u as k}from"./DUKX-aPY.js";const te={class:"main-container"},ae={class:"submit-buttons"},oe={__name:"ProductRegister",setup(U){const x=ee(),A=Q(),w=o(1),P=o(10),v=o(""),f=o(),g=o(""),b=o(),d=o(""),m=o(""),V=o(""),B=o([]),C=o(!1),t=W({name:[],status:[],description:[],price:[],anverso:[],reverso:[],selectedCategory:[]}),F=()=>{const r=v.value.trim();return r?r.length<8?(t.name=["El nombre debe tener por lo menos 8 caracteres"],!1):r.length>50?(t.name=["El nombre no puede exceder los 50 caracteres"],!1):!0:(t.name=["El nombre es requerido"],!1)},D=()=>{const r=parseFloat(f.value);return isNaN(r)?(t.status=["El estado debe ser un número válido"],!1):r<1?(t.status=["El estado debe ser al menos 1"],!1):r>10?(t.status=["El estado no puede ser mayor a 10"],!1):!0},L=()=>{const r=g.value.trim();return r?r.length<10?(t.description=["La descripción debe contener por lo menos 10 caracteres"],!1):r.length>500?(t.description=["La descripción no debe exceder los 500 caracteres"],!1):!0:(t.description=["La descripción es requerida"],!1)},T=()=>{const r=parseFloat(b.value);return isNaN(r)?(t.price=["El precio debe ser un número válido"],!1):r<1e3?(t.price=["El precio debe ser mayor a 1000"],!1):r>2e7?(t.price=["El precio no debe superar 20000000"],!1):!0},z=()=>d.value?d.value instanceof File?!0:(t.anverso=["El archivo seleccionado no es válido"],!1):(t.anverso=["Selecciona una imagen para el anverso"],!1),O=()=>m.value?m.value instanceof File?!0:(t.reverso=["El archivo seleccionado no es válido"],!1):(t.reverso=["Selecciona una imagen para el reverso"],!1),j=()=>{const r=parseInt(V.value);return isNaN(r)||r<1?(t.selectedCategory=["La categoría es requerida"],!1):!0},M=()=>{for(const _ in t)t.hasOwnProperty(_)&&(t[_]=[]);const r=F(),e=D(),u=L(),n=T(),p=z(),E=O(),S=j();return r&&e&&u&&n&&p&&E&&S},G=async()=>{try{const{data:r}=await k(`${x.public.API_BASE_URL}categories?page=1&pageSize=1`,"$hNT7z4Nbnj"),e=r.value.totalItems;P.value=e;const{data:u,error:n}=await k(`${x.public.API_BASE_URL}/categories?page=${w.value}&pageSize=${P.value}`,"$015g0dt9bj");if(!n.value)B.value=u.value.data.map(p=>({id:p.id,name:p.name}));else throw new Error(n.value.message)}catch(r){console.error("Error loading categories:",r),N.fire({title:"Error al cargar categorías",icon:"error",text:"No se pudieron cargar las categorías.",confirmButtonText:"Aceptar"})}};X(async()=>{await Y(),await G()});const H=async()=>{if(!M()){N.fire({title:"Formulario Inválido",icon:"warning",text:"Por favor, completa los campos.",confirmButtonText:"Aceptar"});return}const r=new FormData;r.append("name",v.value.trim()),r.append("status",f.value),r.append("description",g.value.trim()),r.append("price",b.value),r.append("anverso",d.value),r.append("reverso",m.value),r.append("categoryId",V.value);try{C.value=!0;const e=await fetch(`${x.public.API_BASE_URL}products`,{method:"POST",body:r,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok)N.fire({title:"Producto registrado con éxito!",icon:"success",confirmButtonText:"Aceptar"}),R();else{const u=await e.json();throw new Error(u.message||"Error al registrar el producto.")}}catch(e){console.error("Error registering product:",e),N.fire({title:"Error al registrar el producto",icon:"error",text:e.message||"No se pudo registrar el producto.",confirmButtonText:"Aceptar"})}finally{C.value=!1}},R=()=>{v.value="",f.value=null,g.value="",b.value=null,d.value=null,m.value=null,V.value=null;for(const r in t)t.hasOwnProperty(r)&&(t[r]=[])},i=r=>{t[r]=[]};return(r,e)=>{const u=c("v-icon"),n=c("v-text-field"),p=c("v-textarea"),E=c("v-file-input"),S=c("v-autocomplete"),_=c("v-btn"),J=c("v-container");return q(),Z("div",te,[s(u,{class:"exit-icon",onClick:e[0]||(e[0]=a=>l(A).back())},{default:y(()=>e[15]||(e[15]=[$("mdi-arrow-left")])),_:1}),s(J,{class:"form-container"},{default:y(()=>[e[18]||(e[18]=I("h1",{class:"title"},"Registro de productos",-1)),I("form",{onSubmit:h(H,["prevent"])},[s(n,{class:"input",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=a=>v.value=a),label:"Nombre","error-messages":l(t).name,onInput:e[2]||(e[2]=a=>i("name")),required:""},null,8,["modelValue","error-messages"]),s(n,{class:"input",modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=a=>f.value=a),label:"Estado","error-messages":l(t).status,onInput:e[4]||(e[4]=a=>i("status")),required:""},null,8,["modelValue","error-messages"]),s(p,{class:"text-area",modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=a=>g.value=a),label:"Descripción","error-messages":l(t).description,onInput:e[6]||(e[6]=a=>i("description")),required:""},null,8,["modelValue","error-messages"]),s(n,{class:"input",modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=a=>b.value=a),label:"Precio","error-messages":l(t).price,onInput:e[8]||(e[8]=a=>i("price")),type:"number",required:""},null,8,["modelValue","error-messages"]),s(E,{class:"file-input",modelValue:d.value,"onUpdate:modelValue":e[9]||(e[9]=a=>d.value=a),label:"Anverso",accept:"image/*","error-messages":l(t).anverso,onChange:e[10]||(e[10]=a=>i("anverso")),required:""},null,8,["modelValue","error-messages"]),s(E,{class:"file-input",modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=a=>m.value=a),label:"Reverso",accept:"image/*","error-messages":l(t).reverso,onChange:e[12]||(e[12]=a=>i("reverso")),required:""},null,8,["modelValue","error-messages"]),s(S,{class:"select",modelValue:V.value,"onUpdate:modelValue":[e[13]||(e[13]=a=>V.value=a),e[14]||(e[14]=a=>i("selectedCategory"))],items:B.value,"item-title":"name","item-value":"id",label:"Seleccionar Categoría","error-messages":l(t).selectedCategory,required:""},null,8,["modelValue","items","error-messages"]),I("div",ae,[s(_,{class:"submit",type:"submit",loading:C.value},{default:y(()=>e[16]||(e[16]=[$("Enviar")])),_:1},8,["loading"]),s(_,{class:"clean",onClick:R},{default:y(()=>e[17]||(e[17]=[$("Limpiar")])),_:1})])],32)]),_:1})])}}},se=K(oe,[["__scopeId","data-v-30f7935d"]]),ue={__name:"register",setup(U){return(x,A)=>{const w=se;return q(),re(w)}}};export{ue as default};
