import{_ as ee}from"./DQnI19B-.js";import{r as i,m as l,o as C,c as E,b as t,w as a,d as _,F as P,z,_ as te,A as ae,s as oe,v as R,g as $,a as u,C as ne,y as le,t as h,D as L,n as se,x as re}from"./DX0_N7Ks.js";import{C as ie}from"./DFwW1-h0.js";import{S as T}from"./DOYwHpwi.js";import{u as F}from"./DCbp3Bu8.js";const ce={__name:"CategoryDelete",props:{category:Object},emits:["deleted"],setup(V,{emit:y}){const w=z(),v=V,m=y,g=i({...v.category}),p=async()=>{try{await F(`${w.public.API_BASE_URL}categories/${v.category.id}`,{method:"DELETE"},"$o02dgv0U7J")!=null?(T.fire({title:"Eliminado",text:"Categoría eliminada correctamente",icon:"success",confirmButtonText:"Aceptar"}),m("deleted",g.value.id)):(T.fire({title:"Error",text:"No se pudo eliminar la categoría",icon:"error",confirmButtonText:"Aceptar"}),m("deleted",!1,null))}catch(f){console.log("Error",f)}};return(f,c)=>{const b=l("v-card-title"),s=l("v-card-text"),x=l("v-btn"),r=l("v-card-actions");return C(),E(P,null,[t(b,{class:"headline"},{default:a(()=>c[0]||(c[0]=[_("Eliminar categoría")])),_:1}),t(s,null,{default:a(()=>c[1]||(c[1]=[_("¿Estás seguro que quieres eliminar esta categoría?")])),_:1}),t(r,null,{default:a(()=>[t(x,{color:"green darken-1",text:"",onClick:p},{default:a(()=>c[2]||(c[2]=[_("Si, eliminar")])),_:1})]),_:1})],64)}}},de={class:"header-container"},ue={class:"category-container"},_e=["src"],ve={class:"category-info"},me={class:"text-center"},ge={__name:"InterfazUser",setup(V){const y=z(),w=ae(),v=i(1),m=i(10),g=i(!1),p=i(!1),f=i(null),c=i(null),b=i([]),s=i({data:[],totalPages:1}),x=i(""),r=async()=>{try{const{data:o}=await F(`${y.public.API_BASE_URL}categories?page=${v.value}&pageSize=${m.value}`,"$CbwfwtgAsP");if(o.value)b.value=o.value.data,s.value=o.value;else throw new Error("No se recibieron datos válidos")}catch(o){console.error("Error fetching categories:",o),s.value={data:[],totalPages:1}}},j=o=>o;oe(async()=>{await R(),await r()}),$(x,async o=>{if(await r(),!o.trim()){s.value={data:b.value,totalPages:s.value.totalPages};return}try{const d=await(await fetch(`${y.public.API_BASE_URL}categories/search?query=${encodeURIComponent(o.trim())}`)).json();s.value={data:d,totalPages:1}}catch(e){console.error("Error fetching filtered categories:",e),s.value={data:[],totalPages:1}}}),$(v,async()=>{await r()}),$(m,async()=>{await r()});const q=o=>{o&&o.id?(f.value={...o},g.value=!0):console.error("La categoría no tiene una propiedad id válida.")},O=async o=>{if(o){const e=s.value.data.findIndex(d=>d.id===o.id);e!==-1&&(s.value.data[e]=o)}await r(),g.value=!1},G=async o=>{const e=s.value.data.findIndex(d=>d.id===o);e!==-1&&s.value.data.splice(e,1),await r(),p.value=!1},M=async()=>{await R(),await w.push("/categories/register")},J=async o=>{c.value=o,p.value=!0};return(o,e)=>{const d=l("v-btn"),H=l("v-text-field"),K=l("v-select"),Q=ee,U=l("v-icon"),I=l("v-tooltip"),W=l("v-pagination"),D=l("v-container"),X=l("v-col"),Y=l("v-row"),S=l("v-card-text"),A=l("v-card-actions"),B=l("v-card"),N=l("v-dialog");return C(),E(P,null,[u("div",de,[t(d,{onClick:ne(M,["prevent"]),class:"register-button"},{default:a(()=>e[7]||(e[7]=[_("Registrar categoría")])),_:1}),t(H,{class:"search-field",modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=n=>x.value=n),density:"comfortable",placeholder:"Buscar categorías","prepend-inner-icon":"mdi-magnify",variant:"solo",clearable:"","hide-details":""},null,8,["modelValue"])]),t(K,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=n=>m.value=n),class:"page-select",items:[10,20,30,40,50],label:"Seleccionar categorías por página",onChange:r},null,8,["modelValue"]),u("div",ue,[(C(!0),E(P,null,le(s.value.data||[],n=>(C(),E("div",{class:"category-item",key:n.id},[u("div",null,[u("img",{class:"category-image",src:j(n.imagePath)},null,8,_e)]),t(Q,{to:`/categories/${n.id}`},{default:a(()=>[u("button",ve,[u("h3",null,h(n.name),1),u("p",null,h(n.description),1)])]),_:2},1032,["to"]),t(I,{text:"Editar"},{activator:a(({props:k})=>[t(U,L({ref_for:!0},k,{onClick:Z=>q(n),style:{color:"rgba(228, 192, 11, 0.663)"}}),{default:a(()=>e[8]||(e[8]=[_(" mdi-pencil ")])),_:2},1040,["onClick"])]),_:2},1024),t(I,{text:"Eliminar"},{activator:a(({props:k})=>[t(U,L({ref_for:!0},k,{onClick:Z=>J(n),style:{color:"darkslategrey"}}),{default:a(()=>e[9]||(e[9]=[_(" mdi-delete ")])),_:2},1040,["onClick"])]),_:2},1024)]))),128))]),u("div",me,[t(D,null,{default:a(()=>[t(Y,{justify:"center"},{default:a(()=>[t(X,{cols:"8"},{default:a(()=>[t(D,{class:"max-width"},{default:a(()=>[t(W,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=n=>v.value=n),length:s.value.totalPages||1,class:"my-4",onInput:r},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),t(N,{class:"dialog",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=n=>g.value=n)},{default:a(()=>[t(B,null,{default:a(()=>[e[11]||(e[11]=u("h1",{class:"dialog-title"},"Editar Categoría",-1)),t(S,null,{default:a(()=>[t(ie,{category:f.value,onSave:O},null,8,["category"])]),_:1}),t(A,null,{default:a(()=>[t(d,{class:"cancel-button",text:"",onClick:e[3]||(e[3]=n=>g.value=!1)},{default:a(()=>e[10]||(e[10]=[_("Cancelar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(N,{class:"dialog",modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=n=>p.value=n)},{default:a(()=>[t(B,null,{default:a(()=>[t(S,null,{default:a(()=>[t(ce,{category:c.value,onDeleted:G},null,8,["category"])]),_:1}),t(A,null,{default:a(()=>[t(d,{color:"blue darken-1",text:"",onClick:e[5]||(e[5]=n=>p.value=!1)},{default:a(()=>e[12]||(e[12]=[_(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])],64)}}},pe=te(ge,[["__scopeId","data-v-370b78bc"]]),be={__name:"gestion",setup(V){return(y,w)=>(C(),se(re(pe)))}};export{be as default};
